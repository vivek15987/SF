public class RMPullUnitsController {
    public String strMarketing4_0;
    public RMPullUnitsResponseController objRMPullUnitsResponse;
    public List<Unit__c> arrobjUnits = new List<Unit__c>(); 
    public Set<ID> AccountIds							= new Set<ID>();
    public Set<ID> PropertyIds 							= new Set<ID>();
    public Set<ID> FloorPlanIds 						= new Set<ID>();
    
    public RMPullUnitsController() {}
    
    public void RMPullUnits() {
        //Get Integrations.
        
        
        
        
        
        
        if( !AccountIds.isEmpty() ) {    
        	List<Integration__c> Integrations = [   SELECT
                                                        Id, Name, Account__c, ResMan_API_URL__c,
                                                        ResMan_API_Key__c, ResMan_Integration_Partner_ID__c,
                                                        ResMan_Account_Id__c, Grouping__c,
                                                        ResMan_Vacant_Available__c, ResMan_Vacant_Other__c,
                                                        ResMan_Vacant_Reserved__c, ResMan_Occupied_Leased__c, 
                                                        ResMan_Occupied_Leased_On_Notice__c, 
                                                        ResMan_Occupied_On_Notice__c, ResMan_Occupied_Other__c,
                                                        New_LRO_Setting__c, ResMan_Integration_Active__c, Get_ResMan_Unit_Availability__c
                                                    FROM
                                                        Integration__c
                                                    WHERE
                                                        Account__c IN :AccountIds  
                                                        AND ResMan_Integration_Active__c = true 
                                                 		AND Get_ResMan_Unit_Availability__c != null 
                                                ];
    
            try {
                Set<String> AccountIds = new Set<String>();
                Set<String> GroupingIds = new Set<String>();
                
                Map<String, Map<String, String>> IntegrationCredentials = new  Map<String, Map<String, String>>();
                
                if( !Integrations.isEmpty() ) {
                    for( Integration__c I :Integrations ) {
                        if( I.ResMan_Integration_Active__c == true && I.Get_ResMan_Unit_Availability__c != null ) {
                            Map<String, String> tempIntegrationCredentials = new Map<String, String>();
                            tempIntegrationCredentials.put( 'ResMan_API_URL', I.ResMan_API_URL__c );
                            tempIntegrationCredentials.put( 'ResMan_API_Key', I.ResMan_API_Key__c );
                            tempIntegrationCredentials.put( 'ResMan_Integration_Partner_ID', I.ResMan_Integration_Partner_ID__c );
                            tempIntegrationCredentials.put( 'ResMan_Account_Id', I.ResMan_Account_Id__c );
                            tempIntegrationCredentials.put( 'vacant available', I.ResMan_Vacant_Available__c );
                            tempIntegrationCredentials.put( 'vacant other', I.ResMan_Vacant_Other__c );
                            tempIntegrationCredentials.put( 'vacant reserved', I.ResMan_Vacant_Reserved__c );
                            tempIntegrationCredentials.put( 'occupied leased', I.ResMan_Occupied_Leased__c );
                            tempIntegrationCredentials.put( 'occupied leased on notice', I.ResMan_Occupied_Leased_On_Notice__c );
                            tempIntegrationCredentials.put( 'occupied on notice', I.ResMan_Occupied_On_Notice__c );
                            tempIntegrationCredentials.put( 'occupied other', I.ResMan_Occupied_Other__c );
                        	if( null != I.New_LRO_Setting__c )
                            	tempIntegrationCredentials.put( 'New LRO Setting', I.New_LRO_Setting__c );
                            
                            if( null != I.Grouping__c && !GroupingIds.contains( I.Grouping__c ) ) {
                                GroupingIds.add( I.Grouping__c );
                                IntegrationCredentials.put( I.Grouping__c, tempIntegrationCredentials );
                            } else if( !AccountIds.contains( I.Account__c ) ) {
                                AccountIds.add( I.Account__c );
                                IntegrationCredentials.put( I.Account__c, tempIntegrationCredentials );
                            } 
                       	}
                        
                    }
    
                    List<Property__c> fetchedProperties = new List<Property__c>();
                    fetchedProperties = [SELECT 
                                             Id, Name, Account__c, Account__r.Name, ResMan_Property_Id__c, Last_Unit_Pull__c, Group_Membership__c, Group_Membership__r.Name, LRO_Community_ID__c,
                                             ( SELECT Id, ResMan_Floor_Plan_ID__c FROM Floor_Plans__r WHERE ResMan_Floor_Plan_ID__c != NULL AND Id IN :FloorPlanIds )
                                         FROM 
                                            Property__c 
                                         WHERE
                                            Id IN :PropertyIds
                                        ];
                    
                    for( Property__c Property : fetchedProperties ) {
                        try{ 
                            Boolean IsLROPriceActive = false;
                            Boolean IsLROPriceAndAvailabilityActive = false;
                            Map<String, String> strCredentials = new Map<String, String>();
                            if( null != Property.Group_Membership__c && IntegrationCredentials.containsKey( Property.Group_Membership__c ) ) {
                                strCredentials = IntegrationCredentials.get( Property.Group_Membership__c );
                                if( IntegrationCredentials.get( Property.Group_Membership__c ).containsKey( 'New LRO Setting' ) ) {
                                    if( 'Price' == IntegrationCredentials.get( Property.Group_Membership__c ).get( 'New LRO Setting' ) ) {
                                        IsLROPriceActive = true;
                                    } else if ( 'Price and Availability' == IntegrationCredentials.get( Property.Group_Membership__c ).get( 'New LRO Setting' ) ) {
                                        IsLROPriceActive = true;
                                        IsLROPriceAndAvailabilityActive = true;
                                    }
                                }
                            } else if( IntegrationCredentials.containsKey( Property.Account__c ) ) {
                                strCredentials = IntegrationCredentials.get( Property.Account__c );
                            }
    
                            if( !strCredentials.isEmpty() ) { 
                                objRMPullUnitsResponse = null;
                                this.RMGetMarketing4_0( strCredentials, Property.ResMan_Property_Id__c );
                                
                                if( null != objRMPullUnitsResponse && !objRMPullUnitsResponse.UnitCodes.isEmpty() && !Property.Floor_Plans__r.isEmpty() ) {
                                    
                                    Map<String, String> FloorPlanIdCodes 	= new Map<String, String>();
                                    Set<String> FilteredFloorPlanIds 		= new Set<String>();
                                    
                                    for( Floor_Plan__c floorplan : Property.Floor_Plans__r ) {
                                        FloorPlanIdCodes.put( floorplan.ResMan_Floor_Plan_ID__c, floorplan.Id );
                                        FilteredFloorPlanIds.add( floorplan.Id );
                                    }
                                    
                                    List<Unit__c> Units = [ SELECT
                                                                Id, ResMan_Unit_ID__c, X1_Month_Lease__c, X2_Month_Lease__c, X3_Month_Lease__c, X4_Month_Lease__c, X5_Month_Lease__c, X6_Month_Lease__c, X7_Month_Lease__c, X8_Month_Lease__c, X9_Month_Lease__c, X10_Month_Lease__c, X11_Month_Lease__c, X12_Month_Lease__c, X13_Month_Lease__c, X14_Month_Lease__c, X15_Month_Lease__c, X18_Month_Lease__c, X24_Month_Lease__c   
                                                           FROM
                                                                Unit__c
                                                           WHERE
                                                                ResMan_Unit_ID__c != NULL AND Floor_Plan__c IN : FilteredFloorPlanIds AND Property__c =: Property.Id AND Account__c =: Property.Account__c
                                                          ];
                                    
                                    Map<String, String> UnitCodesandIds = new Map<String, String>();
                                    Map<String, Unit__c> UnitIdsUnits = new Map<String, Unit__c>();
                                    for( Unit__c Unit : Units ) {
                                        UnitCodesandIds.put( Unit.ResMan_Unit_ID__c, Unit.Id );
                                        UnitIdsUnits.put( Unit.ResMan_Unit_ID__c, Unit );
                                    }
    
                                    for( String UnitCode : objRMPullUnitsResponse.UnitCodes ) {
                                        String FloorPlanCode = objRMPullUnitsResponse.UnitsBasicInfo.get( UnitCode ).get( 'UnitType' );
                                        
                                        if( FloorPlanIdCodes.containsKey( FloorPlanCode ) ) {
                                            Unit__c Unit = new Unit__c();
                                            
                                            if( UnitCodesandIds.containsKey( UnitCode ) ) {
                                                Unit.Id = UnitCodesandIds.get( UnitCode );  
                                                Unit.Unit_Type__c = FloorPlanCode;
                                                if( false == IsLROPriceActive ) {
                                                    Unit.X1_Month_Lease__c 	= UnitIdsUnits.get( UnitCode ).X1_Month_Lease__c;
                                                    Unit.X2_Month_Lease__c 	= UnitIdsUnits.get( UnitCode ).X2_Month_Lease__c;
                                                    Unit.X3_Month_Lease__c 	= UnitIdsUnits.get( UnitCode ).X3_Month_Lease__c;
                                                    Unit.X4_Month_Lease__c 	= UnitIdsUnits.get( UnitCode ).X4_Month_Lease__c;
                                                    Unit.X5_Month_Lease__c 	= UnitIdsUnits.get( UnitCode ).X5_Month_Lease__c;
                                                    Unit.X6_Month_Lease__c 	= UnitIdsUnits.get( UnitCode ).X6_Month_Lease__c;
                                                    Unit.X7_Month_Lease__c	= UnitIdsUnits.get( UnitCode ).X7_Month_Lease__c;
                                                    Unit.X8_Month_Lease__c 	= UnitIdsUnits.get( UnitCode ).X8_Month_Lease__c;
                                                    Unit.X9_Month_Lease__c 	= UnitIdsUnits.get( UnitCode ).X9_Month_Lease__c;
                                                    Unit.X10_Month_Lease__c = UnitIdsUnits.get( UnitCode ).X10_Month_Lease__c;
                                                    Unit.X11_Month_Lease__c = UnitIdsUnits.get( UnitCode ).X11_Month_Lease__c;
                                                    Unit.X12_Month_Lease__c = UnitIdsUnits.get( UnitCode ).X12_Month_Lease__c; 
                                                    Unit.X13_Month_Lease__c = UnitIdsUnits.get( UnitCode ).X13_Month_Lease__c; 
                                                    Unit.X14_Month_Lease__c = UnitIdsUnits.get( UnitCode ).X14_Month_Lease__c; 
                                                    Unit.X15_Month_Lease__c = UnitIdsUnits.get( UnitCode ).X15_Month_Lease__c; 
                                                    Unit.X18_Month_Lease__c = UnitIdsUnits.get( UnitCode ).X18_Month_Lease__c; 
                                                    Unit.X24_Month_Lease__c = UnitIdsUnits.get( UnitCode ).X24_Month_Lease__c;
                                                }
                                            } else {
                                                Unit.Floor_Plan__c = FloorPlanIdCodes.get( FloorPlanCode );
                                                Unit.Property__c = Property.Id;
                                                Unit.Account__c = Property.Account__c;
                                                Unit.ResMan_Unit_ID__c = UnitCode;
                                                Unit.Unit_Type__c = FloorPlanCode;
                                            }
                                            
                                            if( objRMPullUnitsResponse.UnitsBasicInfo.get(UnitCode).containsKey('MarketingName') && null != objRMPullUnitsResponse.UnitsBasicInfo.get(UnitCode).get('MarketingName') )
                                                Unit.Name = objRMPullUnitsResponse.UnitsBasicInfo.get(UnitCode).get('MarketingName');
                                            
                                            if( objRMPullUnitsResponse.UnitsBasicInfo.get(UnitCode).containsKey('UnitBedrooms') && null != objRMPullUnitsResponse.UnitsBasicInfo.get(UnitCode).get('UnitBedrooms') )
                                                Unit.Bedrooms__c = Decimal.valueOf( objRMPullUnitsResponse.UnitsBasicInfo.get(UnitCode).get('UnitBedrooms') );
                                            
                                            if( objRMPullUnitsResponse.UnitsBasicInfo.get(UnitCode).containsKey('UnitBathrooms') && null != objRMPullUnitsResponse.UnitsBasicInfo.get(UnitCode).get('UnitBathrooms') )
                                                Unit.Bathrooms__c = Decimal.valueOf( objRMPullUnitsResponse.UnitsBasicInfo.get(UnitCode).get('UnitBathrooms') );
                                            
                                            //Ask once following operation
                                            String MinSquareFeet 		= NULL == objRMPullUnitsResponse.UnitsBasicInfo.get(UnitCode).get( 'MinSquareFeet' ) ? '0':objRMPullUnitsResponse.UnitsBasicInfo.get(UnitCode).get( 'MinSquareFeet' ) ;
                                            String MaxSquareFeet 		= NULL == objRMPullUnitsResponse.UnitsBasicInfo.get(UnitCode).get( 'MaxSquareFeet' ) ? '0':objRMPullUnitsResponse.UnitsBasicInfo.get(UnitCode).get( 'MaxSquareFeet' ) ;
                                            
                                            if( '0' == MaxSquareFeet || MinSquareFeet == MaxSquareFeet )    
                                                Unit.Square_Feet__c 	= MinSquareFeet;
                                            else 
                                                Unit.Square_Feet__c 	= MaxSquareFeet;
                                            
                                            if( !IsLROPriceActive && objRMPullUnitsResponse.UnitsBasicInfo.get(UnitCode).containsKey('MarketRent') && null != objRMPullUnitsResponse.UnitsBasicInfo.get(UnitCode).get('MarketRent') )
                                                Unit.Market_Rent__c = Decimal.valueOf( objRMPullUnitsResponse.UnitsBasicInfo.get(UnitCode).get('MarketRent') );
                                            
                                            if( !IsLROPriceAndAvailabilityActive && objRMPullUnitsResponse.UnitsBasicInfo.get(UnitCode).containsKey('UnitOccupancyStatus') && null != objRMPullUnitsResponse.UnitsBasicInfo.get(UnitCode).get('UnitOccupancyStatus') )
                                                Unit.Occupancy_Status__c = objRMPullUnitsResponse.UnitsBasicInfo.get(UnitCode).get('UnitOccupancyStatus');
                                            
                                            if( !IsLROPriceAndAvailabilityActive && objRMPullUnitsResponse.UnitsBasicInfo.get(UnitCode).containsKey('UnitLeasedStatus') && null != objRMPullUnitsResponse.UnitsBasicInfo.get(UnitCode).get('UnitLeasedStatus') )
                                                Unit.Leased_Status__c = objRMPullUnitsResponse.UnitsBasicInfo.get(UnitCode).get('UnitLeasedStatus');
                                            
                                            if( !IsLROPriceAndAvailabilityActive ) {
                                                Unit.Active__c = false;
                                                if( true == strCredentials.containsKey( Unit.Occupancy_Status__c.toLowerCase() ) && 'Active' == strCredentials.get( Unit.Occupancy_Status__c.toLowerCase() ) ) {
                                                    Unit.Active__c = true;
                                                }
                                                
                                                if( true == strCredentials.containsKey( ( Unit.Occupancy_Status__c + ' ' + Unit.Leased_Status__c ).toLowerCase() ) && 'Active' == strCredentials.get( ( Unit.Occupancy_Status__c + ' ' + Unit.Leased_Status__c ).toLowerCase() ) ){
                                                    Unit.Active__c = true;
                                                }
                                                System.debug('Status - '+ (Unit.Occupancy_Status__c + ' ' + Unit.Leased_Status__c ).toLowerCase() );
                                                System.debug('Unit - ' + Unit );
                                            }
                                            
                                            if( objRMPullUnitsResponse.DepositInfo.get(UnitCode).containsKey('deposit') && null != objRMPullUnitsResponse.DepositInfo.get(UnitCode).get('deposit') )
                                                if( objRMPullUnitsResponse.DepositInfo.get(UnitCode).get('deposit').containsKey('Actual') && null != objRMPullUnitsResponse.DepositInfo.get(UnitCode).get('deposit').get('Actual') )
                                                Unit.Deposit__c = Decimal.valueOf( objRMPullUnitsResponse.DepositInfo.get(UnitCode).get('deposit').get('Actual') );
                                            
                                            if( objRMPullUnitsResponse.UnitsBasicInfo.get(UnitCode).containsKey('VacateDate') && null != objRMPullUnitsResponse.UnitsBasicInfo.get(UnitCode).get('VacateDate') )
                                                Unit.Vacate_Date__c = Date.parse( objRMPullUnitsResponse.UnitsBasicInfo.get(UnitCode).get('VacateDate') );
                                            
                                            if( !IsLROPriceAndAvailabilityActive && objRMPullUnitsResponse.UnitsBasicInfo.get(UnitCode).containsKey('MadeReadyDate') && null != objRMPullUnitsResponse.UnitsBasicInfo.get(UnitCode).get('MadeReadyDate') )
                                                Unit.Made_Ready_Date__c = Date.parse( objRMPullUnitsResponse.UnitsBasicInfo.get(UnitCode).get('MadeReadyDate') );
                                            
                                            if( objRMPullUnitsResponse.UnitsBasicInfo.get(UnitCode).containsKey('VacancyClass') && null != objRMPullUnitsResponse.UnitsBasicInfo.get(UnitCode).get('VacancyClass') )
                                                Unit.Vacancy_Class__c = objRMPullUnitsResponse.UnitsBasicInfo.get(UnitCode).get('VacancyClass');
                                            
                                            if( false == IsLROPriceActive && objRMPullUnitsResponse.OfferTerms.containsKey( UnitCode ) ) {
                                                if( objRMPullUnitsResponse.OfferTerms.get(UnitCode).containsKey('1') && null != objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('1') )
                                                    if( 0.0 != Unit.X1_Month_Lease__c || null != objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('1') )
                                                    Unit.X1_Month_Lease__c = Decimal.valueOf( objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('1') );
                                                
                                                if( objRMPullUnitsResponse.OfferTerms.get(UnitCode).containsKey('2') && null != objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('2') )
                                                    if( 0.0 != Unit.X2_Month_Lease__c || null != objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('2') )
                                                    Unit.X2_Month_Lease__c = Decimal.valueOf( objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('2') );
                                                
                                                if( objRMPullUnitsResponse.OfferTerms.get(UnitCode).containsKey('3') && null != objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('3') )
                                                    if( 0.0 != Unit.X3_Month_Lease__c || null != objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('3') )
                                                    Unit.X3_Month_Lease__c = Decimal.valueOf( objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('3') );
                                                
                                                if( objRMPullUnitsResponse.OfferTerms.get(UnitCode).containsKey('4') && null != objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('4') )
                                                    if( 0.0 != Unit.X4_Month_Lease__c || null != objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('4') )
                                                    Unit.X4_Month_Lease__c = Decimal.valueOf( objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('4') );
                                                
                                                if( objRMPullUnitsResponse.OfferTerms.get(UnitCode).containsKey('5') && null != objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('5') )
                                                    if( 0.0 != Unit.X5_Month_Lease__c || null != objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('5') )
                                                    Unit.X5_Month_Lease__c = Decimal.valueOf( objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('5') );
                                                
                                                if( objRMPullUnitsResponse.OfferTerms.get(UnitCode).containsKey('6') && null != objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('6') )
                                                    if( 0.0 != Unit.X6_Month_Lease__c || null != objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('6') )
                                                    Unit.X6_Month_Lease__c = Decimal.valueOf( objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('6') );
                                                
                                                if( objRMPullUnitsResponse.OfferTerms.get(UnitCode).containsKey('7') && null != objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('7') )
                                                    if( 0.0 != Unit.X7_Month_Lease__c || null != objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('7') )
                                                    Unit.X7_Month_Lease__c = Decimal.valueOf( objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('7') );
                                                
                                                if( objRMPullUnitsResponse.OfferTerms.get(UnitCode).containsKey('8') && null != objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('8') )
                                                    if( 0.0 != Unit.X8_Month_Lease__c || null != objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('8') )
                                                    Unit.X8_Month_Lease__c = Decimal.valueOf( objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('8') );
                                                
                                                if( objRMPullUnitsResponse.OfferTerms.get(UnitCode).containsKey('9') && null != objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('9') )
                                                    if( 0.0 != Unit.X9_Month_Lease__c || null != objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('9') )
                                                    Unit.X9_Month_Lease__c = Decimal.valueOf( objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('9') );
                                                
                                                if( objRMPullUnitsResponse.OfferTerms.get(UnitCode).containsKey('10') && null != objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('10') )
                                                    if( 0.0 != Unit.X10_Month_Lease__c || null != objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('10') )
                                                    Unit.X10_Month_Lease__c = Decimal.valueOf( objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('10') );
                                                
                                                if( objRMPullUnitsResponse.OfferTerms.get(UnitCode).containsKey('11') && null != objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('11') )
                                                    if( 0.0 != Unit.X11_Month_Lease__c || null != objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('11') )
                                                    Unit.X11_Month_Lease__c = Decimal.valueOf( objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('11') );
                                                
                                                if( objRMPullUnitsResponse.OfferTerms.get(UnitCode).containsKey('12') && null != objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('12') )
                                                    if( 0.0 != Unit.X12_Month_Lease__c || null != objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('12') )
                                                    Unit.X12_Month_Lease__c = Decimal.valueOf( objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('12') );
                                                
                                                if( objRMPullUnitsResponse.OfferTerms.get(UnitCode).containsKey('13') && null != objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('13') )
                                                    if( 0.0 != Unit.X13_Month_Lease__c || null != objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('13') )
                                                    Unit.X13_Month_Lease__c = Decimal.valueOf( objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('13') );
                                                
                                                if( objRMPullUnitsResponse.OfferTerms.get(UnitCode).containsKey('14') && null != objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('14') )
                                                    if( 0.0 != Unit.X14_Month_Lease__c || null != objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('14') )
                                                    Unit.X14_Month_Lease__c = Decimal.valueOf( objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('14') );
                                                
                                                if( objRMPullUnitsResponse.OfferTerms.get(UnitCode).containsKey('15') && null != objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('15') )
                                                    if( 0.0 != Unit.X15_Month_Lease__c || null != objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('15') )
                                                    Unit.X15_Month_Lease__c = Decimal.valueOf( objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('15') );
                                                
                                                if( objRMPullUnitsResponse.OfferTerms.get(UnitCode).containsKey('18') && null != objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('18') )
                                                    if( 0.0 != Unit.X18_Month_Lease__c || null != objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('18') )
                                                    Unit.X18_Month_Lease__c = Decimal.valueOf( objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('18') );
                                                
                                                if( objRMPullUnitsResponse.OfferTerms.get(UnitCode).containsKey('24') && null != objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('24') )
                                                    if( 0.0 != Unit.X24_Month_Lease__c || null != objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('24') )
                                                    Unit.X24_Month_Lease__c = Decimal.valueOf( objRMPullUnitsResponse.OfferTerms.get(UnitCode).get('24') );
    
                                            }
                                            this.arrobjUnits.add( Unit );
                                        }
                                    }
                                }
                            }
                            
                        } catch ( Exception e ) {
                        	System.debug( 'Hello' );
                            System.debug( e.getMessage() );
                            System.debug( e.getStackTraceString() );
                        } 
                    }
                }
            } catch( Exception e ) {
                System.debug( e.getMessage() );
                System.debug( e.getStackTraceString() );
                
            }
        }
    }
    
    public void RMGetMarketing4_0( Map<String, String> credentials, String RMPropertyId ) {
        Http httpPro = new Http();
        HttpRequest request = new HttpRequest();
        String BodyContent = 'IntegrationPartnerID=' + credentials.get( 'ResMan_Integration_Partner_ID' ) + '&ApiKey=' + credentials.get( 'ResMan_API_Key' ) + '&AccountID=' + credentials.get( 'ResMan_Account_Id' ) + '&PropertyID=' + RMPropertyId;
        request.setEndPoint( credentials.get( 'ResMan_API_URL' ) + 'MITS/GetMarketing4_0?');
        request.setMethod( 'POST' );
        request.setHeader( 'Content-Type', 'application/x-www-form-urlencoded' );
        request.setHeader( 'Accept', 'application/xml' );
        request.setBody( BodyContent );
        request.setHeader('Content-Length', '100'); 
        request.setTimeout( 120000 );
        
        if( !Test.isRunningTest() ) {
			HTTPResponse res = httpPro.send(request);
        	strMarketing4_0 = res.getBody();   
            //strMarketing4_0 = strMarketing4_0.unescapeHtml4();
           
        } else {
            strMarketing4_0 = '<ILS_Unit> <Identification IDValue="7306" OrganizationName="ResMan" IDType="Number" /> <Units> <Unit> <Identification IDValue="7306" OrganizationName="ResMan" IDType="Number" /> <MarketingName>7306</MarketingName> <UnitType>A2</UnitType> <UnitBedrooms>1</UnitBedrooms> <UnitBathrooms>1</UnitBathrooms> <MinSquareFeet>734</MinSquareFeet> <MaxSquareFeet>734</MaxSquareFeet> <MarketRent>780</MarketRent> <UnitEconomicStatus>residential</UnitEconomicStatus> <UnitOccupancyStatus>occupied</UnitOccupancyStatus> <UnitLeasedStatus>leased</UnitLeasedStatus> <FloorplanName>One Bedroom, One Bath</FloorplanName> <BuildingName>7</BuildingName> <Address AddressType="property"> <AddressLine1>1538 Cable Ranch Rd.</AddressLine1> <AddressLine2>7306</AddressLine2> <City>San Antonio</City> <State>TX</State> <PostalCode>78245</PostalCode> </Address> </Unit> </Units> <Pricing> <MITS-OfferTerm> <EffectiveRent>780.00</EffectiveRent> <Term>1</Term> </MITS-OfferTerm> <MITS-OfferTerm> <EffectiveRent>780.00</EffectiveRent> <Term>2</Term> </MITS-OfferTerm> <MITS-OfferTerm> <EffectiveRent>780.00</EffectiveRent> <Term>3</Term> </MITS-OfferTerm> <MITS-OfferTerm> <EffectiveRent>780.00</EffectiveRent> <Term>4</Term> </MITS-OfferTerm> <MITS-OfferTerm> <EffectiveRent>780.00</EffectiveRent> <Term>5</Term> </MITS-OfferTerm> <MITS-OfferTerm> <EffectiveRent>780.00</EffectiveRent> <Term>6</Term> </MITS-OfferTerm> <MITS-OfferTerm> <EffectiveRent>780.00</EffectiveRent> <Term>7</Term> </MITS-OfferTerm> <MITS-OfferTerm> <EffectiveRent>780.00</EffectiveRent> <Term>8</Term> </MITS-OfferTerm> <MITS-OfferTerm> <EffectiveRent>780.00</EffectiveRent> <Term>9</Term> </MITS-OfferTerm> <MITS-OfferTerm> <EffectiveRent>780.00</EffectiveRent> <Term>10</Term> </MITS-OfferTerm> <MITS-OfferTerm> <EffectiveRent>780.00</EffectiveRent> <Term>11</Term> </MITS-OfferTerm>  <MITS-OfferTerm> <EffectiveRent>780.00</EffectiveRent> <Term>12</Term> </MITS-OfferTerm> <MITS-OfferTerm> <EffectiveRent>775.00</EffectiveRent> <Term>13</Term> </MITS-OfferTerm> <MITS-OfferTerm> <EffectiveRent>775.00</EffectiveRent> <Term>14</Term> </MITS-OfferTerm> <MITS-OfferTerm> <EffectiveRent>775.00</EffectiveRent> <Term>15</Term> </MITS-OfferTerm> <MITS-OfferTerm> <EffectiveRent>770.00</EffectiveRent> <Term>16</Term> </MITS-OfferTerm> <MITS-OfferTerm> <EffectiveRent>765.00</EffectiveRent> <Term>18</Term> </MITS-OfferTerm> <MITS-OfferTerm> <EffectiveRent>760.00</EffectiveRent> <Term>20</Term> </MITS-OfferTerm> <MITS-OfferTerm> <EffectiveRent>755.00</EffectiveRent> <Term>22</Term> </MITS-OfferTerm> <MITS-OfferTerm> <EffectiveRent>753.00</EffectiveRent> <Term>24</Term> </MITS-OfferTerm> </Pricing> <EffectiveRent Avg="765" Min="753" Max="780" /> <Deposit DepositType="deposit"> <Amount AmountType="Actual"> <ValueRange Exact="300.00" /> </Amount> <Description>Escrow Deposit</Description> <PercentRefundable>1300</PercentRefundable> <PortionRefundable>1100</PortionRefundable> </Deposit> <FloorLevel>3</FloorLevel> <Availability> <VacateDate Month="2" Day="17" Year="2015" /> <VacancyClass>Occupied</VacancyClass> <MadeReadyDate Month="2" Day="25" Year="2015" /> </Availability> </ILS_Unit> <ILS_Unit> <Identification IDValue="13103" OrganizationName="ResMan" IDType="Number" /> <Units> <Unit> <Identification IDValue="13103" OrganizationName="ResMan" IDType="Number" /> <MarketingName>13103</MarketingName> <UnitType>A2</UnitType> <UnitBedrooms>1</UnitBedrooms> <UnitBathrooms>1</UnitBathrooms> <MinSquareFeet>587</MinSquareFeet> <MaxSquareFeet>587</MaxSquareFeet> <MarketRent>695</MarketRent> <UnitEconomicStatus>residential</UnitEconomicStatus> <UnitOccupancyStatus>occupied</UnitOccupancyStatus> <UnitLeasedStatus>leased</UnitLeasedStatus> <FloorplanName>One Bedroom, One Bath</FloorplanName> <BuildingName>13</BuildingName> <Address AddressType="property"> <AddressLine1>1538 Cable Ranch Rd.</AddressLine1> <AddressLine2>13103</AddressLine2> <City>San Antonio</City> <State>TX</State> <PostalCode>78245</PostalCode> </Address> </Unit> </Units> <Pricing> <MITS-OfferTerm> <EffectiveRent>695.00</EffectiveRent> <Term>12</Term> </MITS-OfferTerm> <MITS-OfferTerm> <EffectiveRent>690.00</EffectiveRent> <Term>14</Term> </MITS-OfferTerm> <MITS-OfferTerm> <EffectiveRent>685.00</EffectiveRent> <Term>16</Term> </MITS-OfferTerm> <MITS-OfferTerm> <EffectiveRent>675.00</EffectiveRent> <Term>18</Term> </MITS-OfferTerm> <MITS-OfferTerm> <EffectiveRent>670.00</EffectiveRent> <Term>20</Term> </MITS-OfferTerm> <MITS-OfferTerm> <EffectiveRent>668.00</EffectiveRent> <Term>22</Term> </MITS-OfferTerm> <MITS-OfferTerm> <EffectiveRent>665.00</EffectiveRent> <Term>24</Term> </MITS-OfferTerm> </Pricing> <EffectiveRent Avg="678" Min="665" Max="695" /> <Deposit DepositType="deposit"> <Amount AmountType="Actual"> <ValueRange Exact="100.00" /> </Amount> <Description>Escrow Deposit Paid In</Description> <PercentRefundable>100</PercentRefundable> <PortionRefundable>100</PortionRefundable> </Deposit> <FloorLevel>1</FloorLevel> <Availability> <VacateDate Month="2" Day="17" Year="2015" /> <VacancyClass>Occupied</VacancyClass> <MadeReadyDate Month="2" Day="25" Year="2015" /> </Availability> </ILS_Unit>';
        }
       	
        //strMarketing4_0 = '<ResMan><MethodName>GetMarketing4_0</MethodName><Status>Success</Status><AccountID>400</AccountID><PropertyID>b342e58c-f5ba-4c63-b050-cf44439bb37d</PropertyID><Response><?xml version="1.0" encoding="utf-16"?> <PhysicalProperty xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"> <Property> <Identification IDValue="b342e58c-f5ba-4c63-b050-cf44439bb37d" OrganizationName="ResMan" IDType="PropertyID" /> <Identification IDValue="400" OrganizationName="ResMan" IDType="AccountID" /> <PropertyID> <Identification IDValue="b342e58c-f5ba-4c63-b050-cf44439bb37d" OrganizationName="ResMan" IDType="PropertyID" /> <MarketingName>Frontline Fairways</MarketingName> <Address AddressType="Property"> <City>Broomfield</City> <State>CO</State> <PostalCode> </PostalCode> <Country>United States</Country> </Address> <Phone PhoneType="personal"> <PhoneNumber> </PhoneNumber> </Phone> <Phone PhoneType="fax"> <PhoneNumber> </PhoneNumber> </Phone> <Email>Info@falsewebsite.com</Email> </PropertyID> <ILS_Identification ILS_IdentificationType="Unspecified" RentalType="Unspecified"> <Latitude>29.42729</Latitude> <Longitude>-98.652874</Longitude> </ILS_Identification> <Information> <StructureType>Unspecified</StructureType> <BuildingCount>18</BuildingCount> <UnitCount>293</UnitCount> <OfficeHour> <OpenTime>8:00 AM</OpenTime> <CloseTime>10:00 AM</CloseTime> <Day>Sunday</Day> </OfficeHour> <OfficeHour> <OpenTime>2:00 PM</OpenTime> <CloseTime>4:00 PM</CloseTime> <Day>Sunday</Day> </OfficeHour> <OfficeHour> <OpenTime>8:00 AM</OpenTime> <CloseTime>6:00 PM</CloseTime> <Day>Monday</Day> </OfficeHour> <OfficeHour> <OpenTime>8:00 AM</OpenTime> <CloseTime>6:00 PM</CloseTime> <Day>Tuesday</Day> </OfficeHour> <OfficeHour> <OpenTime>8:00 AM</OpenTime> <CloseTime>6:00 PM</CloseTime> <Day>Wednesday</Day> </OfficeHour> <OfficeHour> <OpenTime>8:00 AM</OpenTime> <CloseTime>6:00 PM</CloseTime> <Day>Thursday</Day> </OfficeHour> <OfficeHour> <OpenTime>8:00 AM</OpenTime> <CloseTime>6:00 PM</CloseTime> <Day>Friday</Day> </OfficeHour> <OfficeHour> <OpenTime>10:00 AM</OpenTime> <CloseTime>4:00 PM</CloseTime> <Day>Saturday</Day> </OfficeHour> <ShortDescription>Live A Luxurious Life Style At ABC Property</ShortDescription> <LongDescription>ABC Property is a beautiful, pet friendly community.Convenient and easy access to major highways. The community features a resort style pool, access gates, car care station, pet walk courtyards,health and sports complex. ABC Property features 1, 2, and 3 bedroom apartments for rent with washer/dryer provided, tanning facility, stainless steal appliances, business center, High Speed Internet and more.</LongDescription> <LeaseLength>12 month leases</LeaseLength> <Parking ParkingType="Covered Lot"> <Assigned>false</Assigned> <AssignedFee>Paid</AssignedFee> <SpaceFee>35.00</SpaceFee> <Spaces>5</Spaces> <Comment>Only 5 Covered Parking Spaces Left Don\'t Chance It Texas Weather!</Comment> </Parking> <DrivingDirections>Driving directions to the property</DrivingDirections> <Services Nearest="true"> <Name>Elementary School</Name> <Detail>Barton Elementary </Detail> <DistanceTo>less than a mile away</DistanceTo> <Comment>Close to home</Comment> </Services> <Services Nearest="true"> <Name>Highway</Name> <Detail>Close To All Major Highways</Detail> <DistanceTo>Highway 121 1 street light from the property and 8 minutes from Highway 75 !</DistanceTo> </Services> <Services Nearest="false"> <Name>Other</Name> <Detail>Tanning Facility</Detail> <DistanceTo>Property Clubhouse</DistanceTo> <Comment>Ask an associate about all of the amenities available!</Comment> </Services> <PropertyAvailabilityURL>https://demo.myresman.com/Portal/Applicants/Availability?a=400&amp;p=b342e58c-f5ba-4c63-b050-cf44439bb37d</PropertyAvailabilityURL> </Information> <Fee> <ProrateType>Standard</ProrateType> <LateType>Flat</LateType> <LatePercent>0</LatePercent> <LateMinFee>10.0000</LateMinFee> <LateFeePerDay>50.0000</LateFeePerDay> <NonRefundableHoldFee>0</NonRefundableHoldFee> <AdminFee>149.0000</AdminFee> <ApplicationFee>0</ApplicationFee> <BrokerFee>0</BrokerFee> </Fee> <Amenity AmenityType="Availability24Hours"> <Description>Secure entry</Description> </Amenity> <Building> <Identification IDValue="15" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>15</Name> <Description /> <UnitCount>24</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="11" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>11</Name> <Description /> <UnitCount>12</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="8" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>8</Name> <Description /> <UnitCount>8</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="Ramiro\'s Place" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>Ramiro\'s Place</Name> <Description /> <UnitCount>1</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="17" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>17</Name> <Description /> <UnitCount>24</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="1" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>1</Name> <Description /> <UnitCount>39</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="7" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>7</Name> <Description /> <UnitCount>24</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="16" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>16</Name> <Description /> <UnitCount>24</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="5" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>5</Name> <Description /> <UnitCount>12</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="10" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>10</Name> <Description /> <UnitCount>8</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="9" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>9</Name> <Description /> <UnitCount>13</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="14" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>14</Name> <Description /> <UnitCount>12</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="2" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>2</Name> <Description /> <UnitCount>17</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="12" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>12</Name> <Description /> <UnitCount>23</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="13" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>13</Name> <Description /> <UnitCount>12</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="4" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>4</Name> <Description /> <UnitCount>8</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="3" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>3</Name> <Description /> <UnitCount>24</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="6" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>6</Name> <Description /> <UnitCount>8</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Floorplan> <Identification IDValue="B2" OrganizationName="ResMan" IDType="Name" /> <Name>Two Bedroom, Two Bath</Name> <Comment>The Savannah is our two bedroom, two bathroom apartment home. The Savannah has a spacious living room area with an island kitchen &amp; breakfast bar counter top to entertain guests when you\'re playing host/hostess. Your lovely kitchen has a pantry closet to stock up on all your favorite groceries and a tremendous amount of counter space to utilize when working on a gourmet meal. The Savannah also has a separate dining area with an window view to enjoy the outdoor scenery. This home has a built-in desk &amp; bookshelf for you to set up your office-at-home. The guest bedroom is spaciously designed and accustomed with a walk-in closet. The Savannah also has gorgeous open guest bathroom with a linen closet for your convenience. The master bedroom is tremendously large and conveniently has the master bathroom located in the bedroom, which includes a full-size linen closet and walk-in closet as well.</Comment> <UnitCount>25</UnitCount> <UnitsAvailable>0</UnitsAvailable> <Room RoomType="Bedroom"> <Count>2</Count> <Comment /> </Room> <Room RoomType="Bathroom"> <Count>2.0</Count> <Comment /> </Room> <SquareFeet Avg="954" Min="954" Max="954" /> <MarketRent Min="975" Max="1000" /> <EffectiveRent Avg="978" Min="975" Max="1000" /> <Deposit DepositType="deposit"> <Amount AmountType="Actual"> <ValueRange Exact="200.00" /> </Amount> <Description>Escrow Deposit Paid In</Description> <PercentRefundable>100</PercentRefundable> <PortionRefundable>100</PortionRefundable> </Deposit> </Floorplan> <Floorplan> <Identification IDValue="A1" OrganizationName="ResMan" IDType="Name" /> <Name>One Bedroom, One Bath</Name> <Comment>The Krista is our one bedroom, one bathroom apartment home of 587 sq ft. This gorgeous floor plan has an open concept in the living room &amp; kitchen area. There is a tremendous amount of cabinetry and counter space for you to enjoy within your kitchen. The Krista has additional storage space in the coat closet by the entrance. In your living room, you have a large window view that allows you to enjoy the outdoor scenery. The Krista also has a large walk-in closet and a beautiful vanity area in your bathroom that is located in the bedroom. </Comment> <UnitCount>79</UnitCount> <UnitsAvailable>3</UnitsAvailable> <Room RoomType="Bedroom"> <Count>1</Count> <Comment /> </Room> <Room RoomType="Bathroom"> <Count>1.0</Count> <Comment /> </Room> <SquareFeet Avg="587" Min="587" Max="587" /> <MarketRent Min="7" Max="732" /> <EffectiveRent Avg="673" Min="-23" Max="732" /> <Deposit DepositType="deposit"> <Amount AmountType="Actual"> <ValueRange Exact="100.00" /> </Amount> <Description>Escrow Deposit Paid In</Description> <PercentRefundable>100</PercentRefundable> <PortionRefundable>100</PortionRefundable> </Deposit> <File FileID="" Active="true"> <FileType>Floorplan</FileType> <Name>floorplan-krista.jpg</Name> <Format /> <Src>https://resman.blob.core.windows.net/demo-public/d6855366-63ff-4ccd-ab36-e6f15c916226.jpg</Src> <Rank /> </File> <File FileID="26978c6f-3ece-4310-a953-f184a24fdf23" Active="true"> <FileType>Photo</FileType> <Name>Inside.jpg</Name> <Format>.jpg</Format> <Src>https://resman.blob.core.windows.net/demo-public/105f5355-93fd-4a65-8f25-fa630caa7dfb.jpg</Src> <Rank>2</Rank> </File> </Floorplan> <ILS_Unit> <Identification IDValue="17308" OrganizationName="ResMan" IDType="Number" /> <Units> <Unit> <Identification IDValue="17308" OrganizationName="ResMan" IDType="Number" /> <MarketingName>17308</MarketingName> <UnitType>A1</UnitType> <UnitBedrooms>1</UnitBedrooms> <UnitBathrooms>1</UnitBathrooms> <MinSquareFeet>587</MinSquareFeet> <MaxSquareFeet>587</MaxSquareFeet> <MarketRent>695</MarketRent> <UnitEconomicStatus>residential</UnitEconomicStatus> <UnitOccupancyStatus>occupied</UnitOccupancyStatus> <UnitLeasedStatus>leased</UnitLeasedStatus> <FloorplanName>One Bedroom, One Bath</FloorplanName> <BuildingName>17</BuildingName> <Address AddressType="property"> <AddressLine1>1538 Cable Ranch Rd.</AddressLine1> <AddressLine2>17308</AddressLine2> <City>San Antonio</City> <State>TX</State> <PostalCode>78245</PostalCode> </Address> </Unit> </Units> <Pricing> <MITS-OfferTerm> <EffectiveRent>695.00</EffectiveRent> <Term>12</Term> </MITS-OfferTerm> <MITS-OfferTerm> <EffectiveRent>690.00</EffectiveRent> <Term>14</Term> </MITS-OfferTerm> <MITS-OfferTerm> <EffectiveRent>685.00</EffectiveRent> <Term>16</Term> </MITS-OfferTerm> <MITS-OfferTerm> <EffectiveRent>675.00</EffectiveRent> <Term>18</Term> </MITS-OfferTerm> <MITS-OfferTerm> <EffectiveRent>670.00</EffectiveRent> <Term>20</Term> </MITS-OfferTerm> <MITS-OfferTerm> <EffectiveRent>668.00</EffectiveRent> <Term>22</Term> </MITS-OfferTerm> <MITS-OfferTerm> <EffectiveRent>665.00</EffectiveRent> <Term>24</Term> </MITS-OfferTerm> </Pricing> <EffectiveRent Avg="678" Min="665" Max="695" /> <Deposit DepositType="deposit"> <Amount AmountType="Actual"> <ValueRange Exact="100.00" /> </Amount> <Description>Escrow Deposit Paid In</Description> <PercentRefundable>100</PercentRefundable> <PortionRefundable>100</PortionRefundable> </Deposit> <FloorLevel>3</FloorLevel> <Availability> <VacateDate Month="2" Day="12" Year="2015" /> <VacancyClass>Occupied</VacancyClass> <MadeReadyDate Month="2" Day="20" Year="2015" /> </Availability> </ILS_Unit> <ILS_Unit> <Identification IDValue="10-201" OrganizationName="ResMan" IDType="Number" /> <Units> <Unit> <Identification IDValue="10-201" OrganizationName="ResMan" IDType="Number" /> <MarketingName>10-201</MarketingName> <UnitType>B1</UnitType> <UnitBedrooms>1</UnitBedrooms> <UnitBathrooms>2</UnitBathrooms> <MinSquareFeet>881</MinSquareFeet> <MaxSquareFeet>881</MaxSquareFeet> <MarketRent>905</MarketRent> <UnitEconomicStatus>residential</UnitEconomicStatus> <UnitOccupancyStatus>occupied</UnitOccupancyStatus> <UnitLeasedStatus>leased</UnitLeasedStatus> <FloorplanName>Two Bedroom, One Bath</FloorplanName> <BuildingName>1</BuildingName> <Address AddressType="property"> <AddressLine1>2636 Grand Ave 201</AddressLine1> <City>San Diego</City> <State>CA</State> <PostalCode>92109</PostalCode> <Country /> </Address> </Unit> </Units> <Pricing> <MITS-OfferTerm> <EffectiveRent>905.00</EffectiveRent> <Term>12</Term> </MITS-OfferTerm> </Pricing> <EffectiveRent Avg="905" Min="905" Max="905" /> <Deposit DepositType="deposit"> <Amount AmountType="Actual"> <ValueRange Exact="200.00" /> </Amount> <Description>Escrow Deposit Paid In</Description> <PercentRefundable>100</PercentRefundable> <PortionRefundable>100</PortionRefundable> </Deposit> <FloorLevel>1</FloorLevel> <Availability> <VacateDate Month="2" Day="12" Year="2015" /> <VacancyClass>Occupied</VacancyClass> <MadeReadyDate Month="2" Day="20" Year="2015" /> </Availability> </ILS_Unit> <Utility> <AirCon>false</AirCon> <BroadbandInternet>true</BroadbandInternet> <Cable>false</Cable> <Electric>false</Electric> <Gas>false</Gas> <Heat>false</Heat> <HotWater>false</HotWater> <Satellite>false</Satellite> <Sewer>false</Sewer> <Telephone>false</Telephone> <Trash>false</Trash> <Water>false</Water> <UtilityPortionIncluded>0.00</UtilityPortionIncluded> </Utility> <File FileID="71fe9d37-17f3-49ef-9df1-1d4b19ee65ad" Active="true"> <FileType>Photo</FileType> <Name>IMG_1090.jpg</Name> <Format>.jpg</Format> <Src>https://resman.blob.core.windows.net/demo-public/f112e064-c35e-4495-a327-34a4cee895d3.jpg</Src> <Rank>12</Rank> </File> <File FileID="5e3c45b9-d6a7-4e80-a11c-311f194c937a" Active="true"> <FileType>Photo</FileType> <Name>12 Ext-3.jpg</Name> <Format>.jpg</Format> <Src>https://resman.blob.core.windows.net/demo-public/f3ba2d00-440a-4624-9ba7-1ebdf188d4f1.jpg</Src> <Rank>12</Rank> </File> </Property> </PhysicalProperty></Response></ResMan>';
		//strMarketing4_0 = '<ResMan><MethodName>GetMarketing4_0</MethodName><Status>Success</Status><AccountID>400</AccountID><PropertyID>b342e58c-f5ba-4c63-b050-cf44439bb37d</PropertyID><Response><?xml version="1.0" encoding="utf-16"?> <PhysicalProperty xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"> <Property> <Identification IDValue="b342e58c-f5ba-4c63-b050-cf44439bb37d" OrganizationName="ResMan" IDType="PropertyID" /> <Identification IDValue="400" OrganizationName="ResMan" IDType="AccountID" /> <PropertyID> <Identification IDValue="b342e58c-f5ba-4c63-b050-cf44439bb37d" OrganizationName="ResMan" IDType="PropertyID" /> <MarketingName>Frontline Fairways</MarketingName> <Address AddressType="Property"> <City>Broomfield</City> <State>CO</State> <PostalCode> </PostalCode> <Country>United States</Country> </Address> <Phone PhoneType="personal"> <PhoneNumber> </PhoneNumber> </Phone> <Phone PhoneType="fax"> <PhoneNumber> </PhoneNumber> </Phone> <Email>Info@falsewebsite.com</Email> </PropertyID> <ILS_Identification ILS_IdentificationType="Unspecified" RentalType="Unspecified"> <Latitude>29.42729</Latitude> <Longitude>-98.652874</Longitude> </ILS_Identification> <Information> <StructureType>Unspecified</StructureType> <BuildingCount>18</BuildingCount> <UnitCount>293</UnitCount> <OfficeHour> <OpenTime>8:00 AM</OpenTime> <CloseTime>10:00 AM</CloseTime> <Day>Sunday</Day> </OfficeHour> <OfficeHour> <OpenTime>2:00 PM</OpenTime> <CloseTime>4:00 PM</CloseTime> <Day>Sunday</Day> </OfficeHour> <OfficeHour> <OpenTime>8:00 AM</OpenTime> <CloseTime>6:00 PM</CloseTime> <Day>Monday</Day> </OfficeHour> <OfficeHour> <OpenTime>8:00 AM</OpenTime> <CloseTime>6:00 PM</CloseTime> <Day>Tuesday</Day> </OfficeHour> <OfficeHour> <OpenTime>8:00 AM</OpenTime> <CloseTime>6:00 PM</CloseTime> <Day>Wednesday</Day> </OfficeHour> <OfficeHour> <OpenTime>8:00 AM</OpenTime> <CloseTime>6:00 PM</CloseTime> <Day>Thursday</Day> </OfficeHour> <OfficeHour> <OpenTime>8:00 AM</OpenTime> <CloseTime>6:00 PM</CloseTime> <Day>Friday</Day> </OfficeHour> <OfficeHour> <OpenTime>10:00 AM</OpenTime> <CloseTime>4:00 PM</CloseTime> <Day>Saturday</Day> </OfficeHour> <ShortDescription>Live A Luxurious Life Style At ABC Property</ShortDescription> <LongDescription>ABC Property is a beautiful, pet friendly community.Convenient and easy access to major highways. The community features a resort style pool, access gates, car care station, pet walk courtyards,health and sports complex. ABC Property features 1, 2, and 3 bedroom apartments for rent with washer/dryer provided, tanning facility, stainless steal appliances, business center, High Speed Internet and more.</LongDescription> <LeaseLength>12 month leases</LeaseLength> <Parking ParkingType="Covered Lot"> <Assigned>false</Assigned> <AssignedFee>Paid</AssignedFee> <SpaceFee>35.00</SpaceFee> <Spaces>5</Spaces> <Comment>Only 5 Covered Parking Spaces Left Don\'t Chance It Texas Weather!</Comment> </Parking> <DrivingDirections>Driving directions to the property</DrivingDirections> <Services Nearest="true"> <Name>Elementary School</Name> <Detail>Barton Elementary </Detail> <DistanceTo>less than a mile away</DistanceTo> <Comment>Close to home</Comment> </Services> <Services Nearest="true"> <Name>Highway</Name> <Detail>Close To All Major Highways</Detail> <DistanceTo>Highway 121 1 street light from the property and 8 minutes from Highway 75 !</DistanceTo> </Services> <Services Nearest="false"> <Name>Other</Name> <Detail>Tanning Facility</Detail> <DistanceTo>Property Clubhouse</DistanceTo> <Comment>Ask an associate about all of the amenities available!</Comment> </Services> <PropertyAvailabilityURL>https://demo.myresman.com/Portal/Applicants/Availability?a=400&amp;p=b342e58c-f5ba-4c63-b050-cf44439bb37d</PropertyAvailabilityURL> </Information> <Fee> <ProrateType>Standard</ProrateType> <LateType>Flat</LateType> <LatePercent>0</LatePercent> <LateMinFee>10.0000</LateMinFee> <LateFeePerDay>50.0000</LateFeePerDay> <NonRefundableHoldFee>0</NonRefundableHoldFee> <AdminFee>149.0000</AdminFee> <ApplicationFee>0</ApplicationFee> <BrokerFee>0</BrokerFee> </Fee> <Amenity AmenityType="Availability24Hours"> <Description>Secure entry</Description> </Amenity> <Building> <Identification IDValue="15" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>15</Name> <Description /> <UnitCount>24</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="11" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>11</Name> <Description /> <UnitCount>12</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="8" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>8</Name> <Description /> <UnitCount>8</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="Ramiro\'s Place" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>Ramiro\'s Place</Name> <Description /> <UnitCount>1</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="17" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>17</Name> <Description /> <UnitCount>24</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="1" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>1</Name> <Description /> <UnitCount>39</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="7" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>7</Name> <Description /> <UnitCount>24</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="16" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>16</Name> <Description /> <UnitCount>24</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="5" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>5</Name> <Description /> <UnitCount>12</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="10" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>10</Name> <Description /> <UnitCount>8</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="9" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>9</Name> <Description /> <UnitCount>13</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="14" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>14</Name> <Description /> <UnitCount>12</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="2" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>2</Name> <Description /> <UnitCount>17</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="12" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>12</Name> <Description /> <UnitCount>23</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="13" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>13</Name> <Description /> <UnitCount>12</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="4" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>4</Name> <Description /> <UnitCount>8</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="3" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>3</Name> <Description /> <UnitCount>24</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="6" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>6</Name> <Description /> <UnitCount>8</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Floorplan> <Identification IDValue="B2" OrganizationName="ResMan" IDType="Name" /> <Name>Two Bedroom, Two Bath</Name> <Comment>The Savannah is our two bedroom, two bathroom apartment home. The Savannah has a spacious living room area with an island kitchen &amp; breakfast bar counter top to entertain guests when you\'re playing host/hostess. Your lovely kitchen has a pantry closet to stock up on all your favorite groceries and a tremendous amount of counter space to utilize when working on a gourmet meal. The Savannah also has a separate dining area with an window view to enjoy the outdoor scenery. This home has a built-in desk &amp; bookshelf for you to set up your office-at-home. The guest bedroom is spaciously designed and accustomed with a walk-in closet. The Savannah also has gorgeous open guest bathroom with a linen closet for your convenience. The master bedroom is tremendously large and conveniently has the master bathroom located in the bedroom, which includes a full-size linen closet and walk-in closet as well.</Comment> <UnitCount>25</UnitCount> <UnitsAvailable>0</UnitsAvailable> <Room RoomType="Bedroom"> <Count>2</Count> <Comment /> </Room> <Room RoomType="Bathroom"> <Count>2.0</Count> <Comment /> </Room> <SquareFeet Avg="954" Min="954" Max="954" /> <MarketRent Min="975" Max="1000" /> <EffectiveRent Avg="978" Min="975" Max="1000" /> <Deposit DepositType="deposit"> <Amount AmountType="Actual"> <ValueRange Exact="200.00" /> </Amount> <Description>Escrow Deposit Paid In</Description> <PercentRefundable>100</PercentRefundable> <PortionRefundable>100</PortionRefundable> </Deposit> </Floorplan> <Floorplan> <Identification IDValue="A1" OrganizationName="ResMan" IDType="Name" /> <Name>One Bedroom, One Bath</Name> <Comment>The Krista is our one bedroom, one bathroom apartment home of 587 sq ft. This gorgeous floor plan has an open concept in the living room &amp; kitchen area. There is a tremendous amount of cabinetry and counter space for you to enjoy within your kitchen. The Krista has additional storage space in the coat closet by the entrance. In your living room, you have a large window view that allows you to enjoy the outdoor scenery. The Krista also has a large walk-in closet and a beautiful vanity area in your bathroom that is located in the bedroom. </Comment> <UnitCount>79</UnitCount> <UnitsAvailable>3</UnitsAvailable> <Room RoomType="Bedroom"> <Count>1</Count> <Comment /> </Room> <Room RoomType="Bathroom"> <Count>1.0</Count> <Comment /> </Room> <SquareFeet Avg="587" Min="587" Max="587" /> <MarketRent Min="7" Max="732" /> <EffectiveRent Avg="673" Min="-23" Max="732" /> <Deposit DepositType="deposit"> <Amount AmountType="Actual"> <ValueRange Exact="100.00" /> </Amount> <Description>Escrow Deposit Paid In</Description> <PercentRefundable>100</PercentRefundable> <PortionRefundable>100</PortionRefundable> </Deposit> <File FileID="" Active="true"> <FileType>Floorplan</FileType> <Name>floorplan-krista.jpg</Name> <Format /> <Src>https://resman.blob.core.windows.net/demo-public/d6855366-63ff-4ccd-ab36-e6f15c916226.jpg</Src> <Rank /> </File> <File FileID="26978c6f-3ece-4310-a953-f184a24fdf23" Active="true"> <FileType>Photo</FileType> <Name>Inside.jpg</Name> <Format>.jpg</Format> <Src>https://resman.blob.core.windows.net/demo-public/105f5355-93fd-4a65-8f25-fa630caa7dfb.jpg</Src> <Rank>2</Rank> </File> </Floorplan><Utility> <AirCon>false</AirCon> <BroadbandInternet>true</BroadbandInternet> <Cable>false</Cable> <Electric>false</Electric> <Gas>false</Gas> <Heat>false</Heat> <HotWater>false</HotWater> <Satellite>false</Satellite> <Sewer>false</Sewer> <Telephone>false</Telephone> <Trash>false</Trash> <Water>false</Water> <UtilityPortionIncluded>0.00</UtilityPortionIncluded> </Utility> <File FileID="71fe9d37-17f3-49ef-9df1-1d4b19ee65ad" Active="true"> <FileType>Photo</FileType> <Name>IMG_1090.jpg</Name> <Format>.jpg</Format> <Src>https://resman.blob.core.windows.net/demo-public/f112e064-c35e-4495-a327-34a4cee895d3.jpg</Src> <Rank>12</Rank> </File> <File FileID="5e3c45b9-d6a7-4e80-a11c-311f194c937a" Active="true"> <FileType>Photo</FileType> <Name>12 Ext-3.jpg</Name> <Format>.jpg</Format> <Src>https://resman.blob.core.windows.net/demo-public/f3ba2d00-440a-4624-9ba7-1ebdf188d4f1.jpg</Src> <Rank>12</Rank> </File> </Property> </PhysicalProperty></Response></ResMan>';
        //strMarketing4_0 = '<ResMan><MethodName>GetMarketing4_0</MethodName><Status>Success</Status><AccountID>400</AccountID><PropertyID>b342e58c-f5ba-4c63-b050-cf44439bb37d</PropertyID><Response><?xml version="1.0" encoding="utf-16"?> <PhysicalProperty xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"> <Property> <Identification IDValue="b342e58c-f5ba-4c63-b050-cf44439bb37d" OrganizationName="ResMan" IDType="PropertyID" /> <Identification IDValue="400" OrganizationName="ResMan" IDType="AccountID" /> <PropertyID> <Identification IDValue="b342e58c-f5ba-4c63-b050-cf44439bb37d" OrganizationName="ResMan" IDType="PropertyID" /> <MarketingName>Frontline Fairways</MarketingName> <Address AddressType="Property"> <City>Broomfield</City> <State>CO</State> <PostalCode> </PostalCode> <Country>United States</Country> </Address> <Phone PhoneType="personal"> <PhoneNumber> </PhoneNumber> </Phone> <Phone PhoneType="fax"> <PhoneNumber> </PhoneNumber> </Phone> <Email>Info@falsewebsite.com</Email> </PropertyID> <ILS_Identification ILS_IdentificationType="Unspecified" RentalType="Unspecified"> <Latitude>29.42729</Latitude> <Longitude>-98.652874</Longitude> </ILS_Identification> <Information> <StructureType>Unspecified</StructureType> <BuildingCount>18</BuildingCount> <UnitCount>293</UnitCount> <OfficeHour> <OpenTime>8:00 AM</OpenTime> <CloseTime>10:00 AM</CloseTime> <Day>Sunday</Day> </OfficeHour> <OfficeHour> <OpenTime>2:00 PM</OpenTime> <CloseTime>4:00 PM</CloseTime> <Day>Sunday</Day> </OfficeHour> <OfficeHour> <OpenTime>8:00 AM</OpenTime> <CloseTime>6:00 PM</CloseTime> <Day>Monday</Day> </OfficeHour> <OfficeHour> <OpenTime>8:00 AM</OpenTime> <CloseTime>6:00 PM</CloseTime> <Day>Tuesday</Day> </OfficeHour> <OfficeHour> <OpenTime>8:00 AM</OpenTime> <CloseTime>6:00 PM</CloseTime> <Day>Wednesday</Day> </OfficeHour> <OfficeHour> <OpenTime>8:00 AM</OpenTime> <CloseTime>6:00 PM</CloseTime> <Day>Thursday</Day> </OfficeHour> <OfficeHour> <OpenTime>8:00 AM</OpenTime> <CloseTime>6:00 PM</CloseTime> <Day>Friday</Day> </OfficeHour> <OfficeHour> <OpenTime>10:00 AM</OpenTime> <CloseTime>4:00 PM</CloseTime> <Day>Saturday</Day> </OfficeHour> <ShortDescription>Live A Luxurious Life Style At ABC Property</ShortDescription> <LongDescription>ABC Property is a beautiful, pet friendly community.Convenient and easy access to major highways. The community features a resort style pool, access gates, car care station, pet walk courtyards,health and sports complex. ABC Property features 1, 2, and 3 bedroom apartments for rent with washer/dryer provided, tanning facility, stainless steal appliances, business center, High Speed Internet and more.</LongDescription> <LeaseLength>12 month leases</LeaseLength> <Parking ParkingType="Covered Lot"> <Assigned>false</Assigned> <AssignedFee>Paid</AssignedFee> <SpaceFee>35.00</SpaceFee> <Spaces>5</Spaces> <Comment>Only 5 Covered Parking Spaces Left Don\'t Chance It Texas Weather!</Comment> </Parking> <DrivingDirections>Driving directions to the property</DrivingDirections> <Services Nearest="true"> <Name>Elementary School</Name> <Detail>Barton Elementary </Detail> <DistanceTo>less than a mile away</DistanceTo> <Comment>Close to home</Comment> </Services> <Services Nearest="true"> <Name>Highway</Name> <Detail>Close To All Major Highways</Detail> <DistanceTo>Highway 121 1 street light from the property and 8 minutes from Highway 75 !</DistanceTo> </Services> <Services Nearest="false"> <Name>Other</Name> <Detail>Tanning Facility</Detail> <DistanceTo>Property Clubhouse</DistanceTo> <Comment>Ask an associate about all of the amenities available!</Comment> </Services> <PropertyAvailabilityURL>https://demo.myresman.com/Portal/Applicants/Availability?a=400&amp;p=b342e58c-f5ba-4c63-b050-cf44439bb37d</PropertyAvailabilityURL> </Information> <Fee> <ProrateType>Standard</ProrateType> <LateType>Flat</LateType> <LatePercent>0</LatePercent> <LateMinFee>10.0000</LateMinFee> <LateFeePerDay>50.0000</LateFeePerDay> <NonRefundableHoldFee>0</NonRefundableHoldFee> <AdminFee>149.0000</AdminFee> <ApplicationFee>0</ApplicationFee> <BrokerFee>0</BrokerFee> </Fee> <Amenity AmenityType="Availability24Hours"> <Description>Secure entry</Description> </Amenity> <Building> <Identification IDValue="15" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>15</Name> <Description /> <UnitCount>24</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="11" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>11</Name> <Description /> <UnitCount>12</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="8" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>8</Name> <Description /> <UnitCount>8</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="Ramiro\'s Place" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>Ramiro\'s Place</Name> <Description /> <UnitCount>1</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="17" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>17</Name> <Description /> <UnitCount>24</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="1" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>1</Name> <Description /> <UnitCount>39</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="7" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>7</Name> <Description /> <UnitCount>24</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="16" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>16</Name> <Description /> <UnitCount>24</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="5" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>5</Name> <Description /> <UnitCount>12</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="10" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>10</Name> <Description /> <UnitCount>8</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="9" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>9</Name> <Description /> <UnitCount>13</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="14" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>14</Name> <Description /> <UnitCount>12</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="2" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>2</Name> <Description /> <UnitCount>17</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="12" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>12</Name> <Description /> <UnitCount>23</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="13" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>13</Name> <Description /> <UnitCount>12</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="4" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>4</Name> <Description /> <UnitCount>8</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="3" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>3</Name> <Description /> <UnitCount>24</UnitCount> <SquareFeet>0</SquareFeet> </Building> <Building> <Identification IDValue="6" OrganizationName="ResMan" IDType="Name" /> <BuildingType>Unspecified</BuildingType> <Name>6</Name> <Description /> <UnitCount>8</UnitCount> <SquareFeet>0</SquareFeet> </Building><Utility> <AirCon>false</AirCon> <BroadbandInternet>true</BroadbandInternet> <Cable>false</Cable> <Electric>false</Electric> <Gas>false</Gas> <Heat>false</Heat> <HotWater>false</HotWater> <Satellite>false</Satellite> <Sewer>false</Sewer> <Telephone>false</Telephone> <Trash>false</Trash> <Water>false</Water> <UtilityPortionIncluded>0.00</UtilityPortionIncluded> </Utility> <File FileID="71fe9d37-17f3-49ef-9df1-1d4b19ee65ad" Active="true"> <FileType>Photo</FileType> <Name>IMG_1090.jpg</Name> <Format>.jpg</Format> <Src>https://resman.blob.core.windows.net/demo-public/f112e064-c35e-4495-a327-34a4cee895d3.jpg</Src> <Rank>12</Rank> </File> <File FileID="5e3c45b9-d6a7-4e80-a11c-311f194c937a" Active="true"> <FileType>Photo</FileType> <Name>12 Ext-3.jpg</Name> <Format>.jpg</Format> <Src>https://resman.blob.core.windows.net/demo-public/f3ba2d00-440a-4624-9ba7-1ebdf188d4f1.jpg</Src> <Rank>12</Rank> </File> </Property> </PhysicalProperty></Response></ResMan>';
        //strMarketing4_0 = '<ILS_Unit> <Identification IDValue="7306" OrganizationName="ResMan" IDType="Number" /> <Units> <Unit> <Identification IDValue="7306" OrganizationName="ResMan" IDType="Number" /> <MarketingName>7306</MarketingName> <UnitType>A2</UnitType> <UnitBedrooms>1</UnitBedrooms> <UnitBathrooms>1</UnitBathrooms> <MinSquareFeet>734</MinSquareFeet> <MaxSquareFeet>734</MaxSquareFeet> <MarketRent>780</MarketRent> <UnitEconomicStatus>residential</UnitEconomicStatus> <UnitOccupancyStatus>occupied</UnitOccupancyStatus> <UnitLeasedStatus>leased</UnitLeasedStatus> <FloorplanName>One Bedroom, One Bath</FloorplanName> <BuildingName>7</BuildingName> <Address AddressType="property"> <AddressLine1>1538 Cable Ranch Rd.</AddressLine1> <AddressLine2>7306</AddressLine2> <City>San Antonio</City> <State>TX</State> <PostalCode>78245</PostalCode> </Address> </Unit> </Units> <Pricing> <MITS-OfferTerm> <EffectiveRent>780.00</EffectiveRent> <Term>12</Term> </MITS-OfferTerm> <MITS-OfferTerm> <EffectiveRent>775.00</EffectiveRent> <Term>14</Term> </MITS-OfferTerm> <MITS-OfferTerm> <EffectiveRent>770.00</EffectiveRent> <Term>16</Term> </MITS-OfferTerm> <MITS-OfferTerm> <EffectiveRent>765.00</EffectiveRent> <Term>18</Term> </MITS-OfferTerm> <MITS-OfferTerm> <EffectiveRent>760.00</EffectiveRent> <Term>20</Term> </MITS-OfferTerm> <MITS-OfferTerm> <EffectiveRent>755.00</EffectiveRent> <Term>22</Term> </MITS-OfferTerm> <MITS-OfferTerm> <EffectiveRent>753.00</EffectiveRent> <Term>24</Term> </MITS-OfferTerm> </Pricing> <EffectiveRent Avg="765" Min="753" Max="780" /> <Deposit DepositType="deposit"> <Amount AmountType="Actual"> <ValueRange Exact="300.00" /> </Amount> <Description>Escrow Deposit</Description> <PercentRefundable>1300</PercentRefundable> <PortionRefundable>1100</PortionRefundable> </Deposit> <FloorLevel>3</FloorLevel> <Availability> <VacateDate Month="2" Day="17" Year="2015" /> <VacancyClass>Occupied</VacancyClass> <MadeReadyDate Month="2" Day="25" Year="2015" /> </Availability> </ILS_Unit> <ILS_Unit> <Identification IDValue="13103" OrganizationName="ResMan" IDType="Number" /> <Units> <Unit> <Identification IDValue="13103" OrganizationName="ResMan" IDType="Number" /> <MarketingName>13103</MarketingName> <UnitType>A1</UnitType> <UnitBedrooms>1</UnitBedrooms> <UnitBathrooms>1</UnitBathrooms> <MinSquareFeet>587</MinSquareFeet> <MaxSquareFeet>587</MaxSquareFeet> <MarketRent>695</MarketRent> <UnitEconomicStatus>residential</UnitEconomicStatus> <UnitOccupancyStatus>occupied</UnitOccupancyStatus> <UnitLeasedStatus>leased</UnitLeasedStatus> <FloorplanName>One Bedroom, One Bath</FloorplanName> <BuildingName>13</BuildingName> <Address AddressType="property"> <AddressLine1>1538 Cable Ranch Rd.</AddressLine1> <AddressLine2>13103</AddressLine2> <City>San Antonio</City> <State>TX</State> <PostalCode>78245</PostalCode> </Address> </Unit> </Units> <Pricing> <MITS-OfferTerm> <EffectiveRent>695.00</EffectiveRent> <Term>12</Term> </MITS-OfferTerm> <MITS-OfferTerm> <EffectiveRent>690.00</EffectiveRent> <Term>14</Term> </MITS-OfferTerm> <MITS-OfferTerm> <EffectiveRent>685.00</EffectiveRent> <Term>16</Term> </MITS-OfferTerm> <MITS-OfferTerm> <EffectiveRent>675.00</EffectiveRent> <Term>18</Term> </MITS-OfferTerm> <MITS-OfferTerm> <EffectiveRent>670.00</EffectiveRent> <Term>20</Term> </MITS-OfferTerm> <MITS-OfferTerm> <EffectiveRent>668.00</EffectiveRent> <Term>22</Term> </MITS-OfferTerm> <MITS-OfferTerm> <EffectiveRent>665.00</EffectiveRent> <Term>24</Term> </MITS-OfferTerm> </Pricing> <EffectiveRent Avg="678" Min="665" Max="695" /> <Deposit DepositType="deposit"> <Amount AmountType="Actual"> <ValueRange Exact="100.00" /> </Amount> <Description>Escrow Deposit Paid In</Description> <PercentRefundable>100</PercentRefundable> <PortionRefundable>100</PortionRefundable> </Deposit> <FloorLevel>1</FloorLevel> <Availability> <VacateDate Month="2" Day="17" Year="2015" /> <VacancyClass>Occupied</VacancyClass> <MadeReadyDate Month="2" Day="25" Year="2015" /> </Availability> </ILS_Unit>';
        
        if( !String.isEmpty(strMarketing4_0) && -1 != strMarketing4_0.indexOf('<ILS_Unit>') ) {
            
            Integer StartIndex = strMarketing4_0.indexOf('<ILS_Unit>');
            Integer LastIndex = strMarketing4_0.lastIndexOf('</ILS_Unit>');
            
            String UnitsStringParts = strMarketing4_0.substring(StartIndex, LastIndex) + '</ILS_Unit>';
            UnitsStringParts = '<PhysicalProperty xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"> <Property>' + UnitsStringParts + '</Property></PhysicalProperty>';
           	
            System.debug( UnitsStringParts );
            
            if( null != UnitsStringParts ) {
                XmlStreamReader reader 				= new XmlStreamReader( UnitsStringParts );
                objRMPullUnitsResponse 				= new RMPullUnitsResponseController();
                objRMPullUnitsResponse.parseUnitResponse( reader );
            }
        }
    }
}